==================================
 CGPOLY
==================================

Welcome to CGPOLY - A package for doing Coarse-Grained Polymer
simulations using Gromacs

Currently this is pretty specific to simulating BPA-PC, but it could
be extended to other polymers as well.

Part of the code is also specific to porting the BPA-PC model from
ESPResSo to Gromacs. The code needs Gromacs 4.x.

Quick start
===========

Run the gen_everything.py script to generate all the tables,
topologies, blahblah and an input file for a BPA-PC system in a 7x7x7
nm box with 80 chains with 43 beads per chain. After that just run
grompp and mdrun to start simulating.

Parameters of the model
=======================

All the parameters are found in the params.py file.

Convert tables
==============

In Espresso angle potential tables are of the form

angle(radians)    (+/-?)force    potential

Gromacs tables are of the form

angle(degrees)   potential   -force

program espresso2gro_table.py converts this.

Run it like

./espresso2gro_table.py PCP_TABLE.DAT table_a0.xvg

./espresso2gro_table.py PIP_TABLE.DAT table_a1.xvg

Note that the numbering of the table files is important, see Topology
section below.

Non-bonded interactions
=======================

The non-bonded interaction tables are generated by the
gen_nb_tables.py script. In order to do force capping, use the -f
option and create tables with capped forces. This is needed for
equilibration.

Topology
========

BPA-PC model beads are defined in bpapc.itp

The bonded interactions are generated by the chain_top.py file. See
the script for the parameters for the bonded interactions and the
gromacs molecule definition.

Run it with

./chain_top.py 43 > bpapc43.itp

to create a molecule topology for a chain of 43 beads

Then in bpapc-single.top there is a topology file for a system with
one chain.

The topology is setup such that the PCP angle bonds should be in
table_a0.xvg and PIP angle bonds in table_a1.xvg.

Starting coordinates
====================

The script gen_poly.py takes care of this.

Index file
==========

The easiest way is to run the make_ndx program included with gromacs
as "make_ndx -f bpapc.gro" where bpapc.gro is the starting
coordinates. Create a group with all phenylenes with "a P*", carbonic
acid group with "a C*" and isopropylediene group with "a I*", rename
the groups with "name 2 P" etc. to remove the "*" from the
names. Finally save and quit.
